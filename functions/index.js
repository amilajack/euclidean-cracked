/**
 * Triggered by a change to a Firebase RTDB reference.
 *
 * @param {!Object} event Event payload and metadata.
 * @param {!Function} callback Callback function to signal completion.
 */

const functions = require('firebase-functions');

// The Firebase Admin SDK to access the Firebase Realtime Database.
const admin = require('firebase-admin');
admin.initializeApp();

exports.sanitizer = functions.database.ref('/customFunctions/{customFunctionId}').onWrite((change) => {
  const beforeCustomFunction = change.before.val(); // data before the write
  //incoming snapshot of customFunction model
  const customFunction = change.after.val(); // data after the write
  /*
  
  function checking flow:
  - user types into editorContent property
  - user clicks load and editorContent is saved to functionPreCheck on the client
  - this cloud function sanitizer hook is called and checks for safety of functionPreCheck string, if OK it copies
    content to the record's "function" property and deletes the content of functionPreCheck
  - client can always rely on the "function" property to be safe since it cannot be written by users.
  */
 
  if (customFunction) {
    let cleanFunction;
	  let forbiddenTokens;
	  let precheck = customFunction.functionPreCheck;

    if(precheck !== null){
      //Check for illegal tokens
      forbiddenTokens = getForbidden(precheck);

      // if there are forbiddenTokens as the function is saved,
      // set the function to previous state and return the list to inform the user
      const isSafe = !forbiddenTokens.length;
      // if functionPreCheck in new data is safe, save function with that data
      //if not, save function as the previous state of function
      cleanFunction = isSafe ? precheck : beforeCustomFunction.function;
    }    

    return change.after.ref.update({
      function: cleanFunction,
      functionPreCheck: null,
      illegalTokens: forbiddenTokens.join(' ')
    });
  }
  return null;
});



// remove /* comments */ from header of function string
function removeHeaderComment(s) {
	return s.replace(/(\/\*[^*]*\*\/)|(\/\/[^*]*)/g, '');
}

// Return list of dangerous tokens from user submitted javascript
function getForbidden(functionString) {
  if (functionString) {
    functionString = removeHeaderComment(functionString);
    let forbiddenTokens = functionString
      .replace(/\W/g, ' ').split(' ')
      .map(t => excludes.indexOf(t))
      .filter(idx => idx > -1)
      .map(idx => excludes[idx]);

    // are there any other non alphanumeric tokens to blacklist?
    let nonAlphaForbidden = functionString.indexOf('$');
    if (nonAlphaForbidden > -1) {
      forbiddenTokens.push('$');
    }

    // dedupe
    const unique = new Set(forbiddenTokens);
    forbiddenTokens = Array.from(unique);

    return forbiddenTokens;
  } else {
    return [];
  }
}

const excludes = [
  'eNode',
  'code',
  'col',
  'colgroup',
  'combine',
  'constructor',
  'count',
  'create',
  'createDocumentFragment',
  'createElement',
  'createRange',
  'createTextNode',
  'createTextRange',
  'cssFloat',
  'ctrlKey',
  'currentStyle',
  'dd',
  'document',
  'defaultView',
  'del',
  'dfn',
  'dir',
  'disabled',
  'div',
  'dl',
  'dt',
  'each',
  'empty',
  'enable',
  'ephemeral',
  'eval',
  'exec',
  'expand',
  'explode',
  'fieldset',
  'fire',
  'firstChild',
  'focus',
  'font',
  'form',
  'fragment',
  'fromCharCode',
  'getCheck',
  'getChecks',
  'getClass',
  'getClasses',
  'getComputedStyle',
  'getElementById',
  'getElementsByTagName',
  'getMark',
  'getMarks',
  'getName',
  'getNames',
  'getOffsetHeight',
  'getOffsetHeights',
  'getOffsetWidth',
  'getOffsetWidths',
  'getParent',
  'getSelection',
  'getStyle',
  'getStyles',
  'getTagName',
  'getTagNames',
  'getTitle',
  'getTitles',
  'getValue',
  'getValues',
  'go',
  'h1',
  'h2',
  'h3',
  'h4',
  'h5',
  'h6',
  'has',
  'hasOwnProperty',
  'hr',
  'img',
  'inRange',
  'indeterminate',
  'indexOf',
  'input',
  'ins',
  'insertBefore',
  'isArray',
  'jQuery',
  'kbd',
  'key',
  'keyCode',
  'keys',
  'klass',
  'label',
  'later',
  'legend',
  'li',
  'lib',
  'mark',
  'menu',
  'message',
  'name',
  'navigator',
  'nextSibling',
  'nodeName',
  'nodeValue',
  'offsetHeight',
  'offsetWidth',
  'ol',
  'onclick',
  'ondblclick',
  'onfocusin',
  'onfocusout',
  'onkeypress',
  'onmousedown',
  'onmousemove',
  'onmouseout',
  'onmouseover',
  'onmouseup',
  'op',
  'optgroup',
  'option',
  'p',
  'parent',
  'parentNode',
  'postError',
  'pre',
  'prepend',
  'preventDefault',
  'protect',
  'prototype',
  'remove',
  'removeChild',
  'removeElement',
  'replace',
  'replaceChild',
  'returnValue',
  'row',
  'samp',
  'select',
  'selection',
  'selectionEnd',
  'selectionStart',
  'shiftKey',
  'slice',
  'small',
  'span',
  'srcElement',
  'stack',
  'stopPropagation',
  'strong',
  'style',
  'styleFloat',
  'sub',
  'sup',
  'table',
  'tag',
  'tagName',
  'target',
  'tbody',
  'test',
  'text',
  'textarea',
  'tfoot',
  'that',
  'thead',
  'title',
  'toLowerCase',
  'toString',
  'toUpperCase',
  'tr',
  'tt',
  'type',
  'ul',
  'unwatch',
  'valueOf',
  'visibility',
  'watch',
  'window',
  'writeln',
  'Function',
  'Error',
  'EvalError',
  'RangeError',
  'ReferenceError',
  'SyntaxError',
  'TypeError',
  'URIError',
  'Intl',
  'Uint8ClampedArray',
  'BigUint64Array',
  'BigInt64Array',
  'DataView',
  'Proxy',
  'Reflect',
  'decodeURI',
  'decodeURIComponent',
  'encodeURI',
  'encodeURIComponent',
  'escape',
  'unescape',
  'isFinite',
  'isNaN',
  'ByteLengthQueuingStrategy',
  'CountQueuingStrategy',
  'ReadableStream',
  'WritableStream',
  'TransformStream',
  'webkitRTCPeerConnection',
  'webkitMediaStream',
  'WebSocket',
  'WebGLContextEvent',
  'WaveShaperNode',
  'TextEncoder',
  'TextDecoder',
  'SyncManager',
  'SubtleCrypto',
  'StorageEvent',
  'Storage',
  'StereoPannerNode',
  'SourceBufferList',
  'SourceBuffer',
  'ScriptProcessorNode',
  'ScreenOrientation',
  'RTCtrackEvent',
  'RTCStatsReport',
  'RTCSessionDescription',
  'RTCRtpTransceiver',
  'RTCRtpSender',
  'RTCRtpReceiver',
  'RTCRtpContributingSource',
  'RTCPeerConnectionIceEvent',
  'RTCPeerConnection',
  'RTCIceCandidate',
  'RTCDataChannelEvent',
  'RTCDataChannel',
  'RTCDTMFToneChangeEvent',
  'RTCDTMFSender',
  'RTCCertificate',
  'Plugin',
  'PluginArray',
  'PhotoCapabilities',
  'PeriodicWave',
  'PannerNode',
  'OverconstrainedError',
  'OfflineAudioContext',
  'OfflineAudioCompletionEvent',
  'NetworkInformation',
  'MimeType',
  'MimeTypeArray',
  'MediaStreamTrackEvent',
  'MediaStreamTrack',
  'MediaStreamEvent',
  'MediaStream',
  'MediaSource',
  'MediaSettingsRange',
  'MediaRecorder',
  'MediaEncryptedEvent',
  'MediaDevices',
  'MediaDeviceInfo',
  'MediaCapabilities',
  'InputDeviceInfo',
  'ImageCapture',
  'ImageBitmapRenderingContext',
  'IIRFilterNode',
  'IDBVersionChangeEvent',
  'IDBTransaction',
  'IDBRequest',
  'IDBOpenDBRequest',
  'IDBObjectStore',
  'IDBKeyRange',
  'IDBIndex',
  'IDBFactory',
  'IDBDatabase',
  'IDBCursorWithValue',
  'IDBCursor',
  'GamepadEvent',
  'Gamepad',
  'GamepadButton',
  'GainNode',
  'EventSource',
  'DynamicsCompressorNode',
  'DeviceOrientationEvent',
  'DeviceMotionEvent',
  'DelayNode',
  'DOMError',
  'CryptoKey',
  'Crypto',
  'ConvolverNode',
  'ConstantSourceNode',
  'CloseEvent',
  'ChannelSplitterNode',
  'ChannelMergerNode',
  'CanvasRenderingContext2D',
  'CanvasCaptureMediaStreamTrack',
  'BroadcastChannel',
  'BlobEvent',
  'BiquadFilterNode',
  'BeforeInstallPromptEvent',
  'BatteryManager',
  'BaseAudioContext',
  'AudioWorkletNode',
  'AudioScheduledSourceNode',
  'AudioProcessingEvent',
  'AudioParamMap',
  'AudioParam',
  'AudioNode',
  'AudioListener',
  'AudioDestinationNode',
  'AudioContext',
  'AudioBufferSourceNode',
  'AudioBuffer',
  'AnalyserNode',
  'postMessage',
  'blur',
  'close',
  'XPathResult',
  'XPathExpression',
  'XPathEvaluator',
  'XMLSerializer',
  'XMLHttpRequestUpload',
  'XMLHttpRequestEventTarget',
  'XMLHttpRequest',
  'XMLDocument',
  'Window',
  'WheelEvent',
  'VisualViewport',
  'ValidityState',
  'VTTCue',
  'URLSearchParams',
  'URL',
  'UIEvent',
  'TreeWalker',
  'TransitionEvent',
  'TrackEvent',
  'TouchList',
  'TouchEvent',
  'Touch',
  'TimeRanges',
  'TextTrackList',
  'TextTrackCueList',
  'TextTrackCue',
  'TextTrack',
  'TextMetrics',
  'TextEvent',
  'Text',
  'TaskAttributionTiming',
  'StyleSheetList',
  'StyleSheet',
  'StylePropertyMapReadOnly',
  'StylePropertyMap',
  'StaticRange',
  'ShadowRoot',
  'Selection',
  'SecurityPolicyViolationEvent',
  'Screen',
  'SVGViewElement',
  'SVGUseElement',
  'SVGUnitTypes',
  'SVGTransformList',
  'SVGTransform',
  'SVGTitleElement',
  'SVGTextPositioningElement',
  'SVGTextPathElement',
  'SVGTextElement',
  'SVGTextContentElement',
  'SVGTSpanElement',
  'SVGSymbolElement',
  'SVGSwitchElement',
  'SVGStyleElement',
  'SVGStringList',
  'SVGStopElement',
  'SVGSetElement',
  'SVGScriptElement',
  'SVGSVGElement',
  'SVGRectElement',
  'SVGRect',
  'SVGRadialGradientElement',
  'SVGPreserveAspectRatio',
  'SVGPolylineElement',
  'SVGPolygonElement',
  'SVGPointList',
  'SVGPoint',
  'SVGPatternElement',
  'SVGPathElement',
  'SVGNumberList',
  'SVGNumber',
  'SVGMetadataElement',
  'SVGMatrix',
  'SVGMaskElement',
  'SVGMarkerElement',
  'SVGLinearGradientElement',
  'SVGLineElement',
  'SVGLengthList',
  'SVGLength',
  'SVGImageElement',
  'SVGGraphicsElement',
  'SVGGradientElement',
  'SVGGeometryElement',
  'SVGGElement',
  'SVGForeignObjectElement',
  'SVGFilterElement',
  'SVGFETurbulenceElement',
  'SVGFETileElement',
  'SVGFESpotLightElement',
  'SVGFESpecularLightingElement',
  'SVGFEPointLightElement',
  'SVGFEOffsetElement',
  'SVGFEMorphologyElement',
  'SVGFEMergeNodeElement',
  'SVGFEMergeElement',
  'SVGFEImageElement',
  'SVGFEGaussianBlurElement',
  'SVGFEFuncRElement',
  'SVGFEFuncGElement',
  'SVGFEFuncBElement',
  'SVGFEFuncAElement',
  'SVGFEFloodElement',
  'SVGFEDropShadowElement',
  'SVGFEDistantLightElement',
  'SVGFEDisplacementMapElement',
  'SVGFEDiffuseLightingElement',
  'SVGFEConvolveMatrixElement',
  'SVGFECompositeElement',
  'SVGFEComponentTransferElement',
  'SVGFEColorMatrixElement',
  'SVGFEBlendElement',
  'SVGEllipseElement',
  'SVGElement',
  'SVGDescElement',
  'SVGDefsElement',
  'SVGComponentTransferFunctionElement',
  'SVGClipPathElement',
  'SVGCircleElement',
  'SVGAnimatedTransformList',
  'SVGAnimatedString',
  'SVGAnimatedRect',
  'SVGAnimatedPreserveAspectRatio',
  'SVGAnimatedNumberList',
  'SVGAnimatedNumber',
  'SVGAnimatedLengthList',
  'SVGAnimatedLength',
  'SVGAnimatedInteger',
  'SVGAnimatedEnumeration',
  'SVGAnimatedBoolean',
  'SVGAnimatedAngle',
  'SVGAnimateTransformElement',
  'SVGAnimateMotionElement',
  'SVGAnimateElement',
  'SVGAngle',
  'SVGAElement',
  'Response',
  'ResizeObserverEntry',
  'ResizeObserver',
  'Request',
  'Range',
  'RadioNodeList',
  'PromiseRejectionEvent',
  'ProgressEvent',
  'ProcessingInstruction',
  'PopStateEvent',
  'PointerEvent',
  'PerformanceTiming',
  'PerformanceServerTiming',
  'PerformanceResourceTiming',
  'PerformancePaintTiming',
  'PerformanceObserverEntryList',
  'PerformanceObserver',
  'PerformanceNavigation',
  'PerformanceMeasure',
  'PerformanceMark',
  'PerformanceLongTaskTiming',
  'PerformanceEntry',
  'Performance',
  'PageTransitionEvent',
  'NodeList',
  'NodeIterator',
  'NodeFilter',
  'Node',
  'Navigator',
  'NamedNodeMap',
  'MutationRecord',
  'MutationObserver',
  'MutationEvent',
  'MouseEvent',
  'MessagePort',
  'MessageEvent',
  'MessageChannel',
  'MediaQueryListEvent',
  'MediaQueryList',
  'MediaList',
  'MediaError',
  'Location',
  'KeyboardEvent',
  'IntersectionObserverEntry',
  'IntersectionObserver',
  'InputEvent',
  'InputDeviceCapabilities',
  'ImageData',
  'ImageBitmap',
  'IdleDeadline',
  'History',
  'Headers',
  'HashChangeEvent',
  'HTMLVideoElement',
  'HTMLUnknownElement',
  'HTMLUListElement',
  'HTMLTrackElement',
  'HTMLTitleElement',
  'HTMLTimeElement',
  'HTMLTextAreaElement',
  'HTMLTemplateElement',
  'HTMLTableSectionElement',
  'HTMLTableRowElement',
  'HTMLTableElement',
  'HTMLTableColElement',
  'HTMLTableCellElement',
  'HTMLTableCaptionElement',
  'HTMLStyleElement',
  'HTMLSpanElement',
  'HTMLSourceElement',
  'HTMLSlotElement',
  'HTMLShadowElement',
  'HTMLSelectElement',
  'HTMLScriptElement',
  'HTMLQuoteElement',
  'HTMLProgressElement',
  'HTMLPreElement',
  'HTMLPictureElement',
  'HTMLParamElement',
  'HTMLParagraphElement',
  'HTMLOutputElement',
  'HTMLOptionsCollection',
  'Option',
  'HTMLOptionElement',
  'HTMLOptGroupElement',
  'HTMLObjectElement',
  'HTMLOListElement',
  'HTMLModElement',
  'HTMLMeterElement',
  'HTMLMetaElement',
  'HTMLMenuElement',
  'HTMLMediaElement',
  'HTMLMarqueeElement',
  'HTMLMapElement',
  'HTMLLinkElement',
  'HTMLLegendElement',
  'HTMLLabelElement',
  'HTMLLIElement',
  'HTMLInputElement',
  'Image',
  'HTMLImageElement',
  'HTMLIFrameElement',
  'HTMLHtmlElement',
  'HTMLHeadingElement',
  'HTMLHeadElement',
  'HTMLHRElement',
  'HTMLFrameSetElement',
  'HTMLFrameElement',
  'HTMLFormElement',
  'HTMLFormControlsCollection',
  'HTMLFontElement',
  'HTMLFieldSetElement',
  'HTMLEmbedElement',
  'HTMLElement',
  'HTMLDocument',
  'HTMLDivElement',
  'HTMLDirectoryElement',
  'HTMLDialogElement',
  'HTMLDetailsElement',
  'HTMLDataListElement',
  'HTMLDataElement',
  'HTMLDListElement',
  'HTMLContentElement',
  'HTMLCollection',
  'HTMLCanvasElement',
  'HTMLButtonElement',
  'HTMLBodyElement',
  'HTMLBaseElement',
  'HTMLBRElement',
  'Audio',
  'HTMLAudioElement',
  'HTMLAreaElement',
  'HTMLAnchorElement',
  'HTMLAllCollection',
  'FormData',
  'FontFaceSetLoadEvent',
  'FocusEvent',
  'FileReader',
  'FileList',
  'File',
  'EventTarget',
  'Event',
  'ErrorEvent',
  'Element',
  'DragEvent',
  'DocumentType',
  'DocumentFragment',
  'Document',
  'DataTransferItemList',
  'DataTransferItem',
  'DataTransfer',
  'DOMTokenList',
  'DOMStringMap',
  'DOMStringList',
  'DOMRectReadOnly',
  'DOMRectList',
  'DOMRect',
  'DOMQuad',
  'DOMPointReadOnly',
  'DOMPoint',
  'DOMParser',
  'DOMMatrixReadOnly',
  'DOMMatrix',
  'DOMImplementation',
  'DOMException',
  'CustomEvent',
  'CustomElementRegistry',
  'CompositionEvent',
  'Comment',
  'ClipboardEvent',
  'CharacterData',
  'CSSVariableReferenceValue',
  'CSSUnparsedValue',
  'CSSUnitValue',
  'CSSTranslate',
  'CSSTransformValue',
  'CSSTransformComponent',
  'CSSSupportsRule',
  'CSSStyleValue',
  'CSSStyleSheet',
  'CSSStyleRule',
  'CSSStyleDeclaration',
  'CSSSkewY',
  'CSSSkewX',
  'CSSSkew',
  'CSSScale',
  'CSSRuleList',
  'CSSRule',
  'CSSRotate',
  'CSSPositionValue',
  'CSSPerspective',
  'CSSPageRule',
  'CSSNumericValue',
  'CSSNumericArray',
  'CSSNamespaceRule',
  'CSSMediaRule',
  'CSSMatrixComponent',
  'CSSMathValue',
  'CSSMathSum',
  'CSSMathProduct',
  'CSSMathNegate',
  'CSSMathMin',
  'CSSMathMax',
  'CSSMathInvert',
  'CSSKeywordValue',
  'CSSKeyframesRule',
  'CSSKeyframeRule',
  'CSSImportRule',
  'CSSImageValue',
  'CSSGroupingRule',
  'CSSFontFaceRule',
  'CSS',
  'CSSConditionRule',
  'CDATASection',
  'Blob',
  'BeforeUnloadEvent',
  'BarProp',
  'Attr',
  'AnimationEvent',
  'AbortSignal',
  'AbortController',
  'WebKitCSSMatrix',
  'WebKitMutationObserver',
  'webkitURL',
  'opener',
  'top',
  'length',
  'frames',
  'closed',
  'location',
  'self',
  'customElements',
  'history',
  'locationbar',
  'menubar',
  'personalbar',
  'scrollbars',
  'statusbar',
  'toolbar',
  'status',
  'frameElement',
  'origin',
  'external',
  'screen',
  'innerWidth',
  'innerHeight',
  'scrollX',
  'pageXOffset',
  'scrollY',
  'pageYOffset',
  'visualViewport',
  'screenX',
  'screenY',
  'outerWidth',
  'outerHeight',
  'devicePixelRatio',
  'clientInformation',
  'event',
  'offscreenBuffering',
  'screenLeft',
  'screenTop',
  'defaultStatus',
  'defaultstatus',
  'styleMedia',
  'onanimationend',
  'onanimationiteration',
  'onanimationstart',
  'onsearch',
  'ontransitionend',
  'onwebkitanimationend',
  'onwebkitanimationiteration',
  'onwebkitanimationstart',
  'onwebkittransitionend',
  'isSecureContext',
  'onabort',
  'onblur',
  'oncancel',
  'oncanplay',
  'oncanplaythrough',
  'onchange',
  'onclose',
  'oncontextmenu',
  'oncuechange',
  'ondrag',
  'ondragend',
  'ondragenter',
  'ondragleave',
  'ondragover',
  'ondragstart',
  'ondrop',
  'ondurationchange',
  'onemptied',
  'onended',
  'onerror',
  'onfocus',
  'oninput',
  'oninvalid',
  'onkeydown',
  'onkeyup',
  'onload',
  'onloadeddata',
  'onloadedmetadata',
  'onloadstart',
  'onmouseenter',
  'onmouseleave',
  'onmousewheel',
  'onpause',
  'onplay',
  'onplaying',
  'onprogress',
  'onratechange',
  'onreset',
  'onresize',
  'onscroll',
  'onseeked',
  'onseeking',
  'onselect',
  'onstalled',
  'onsubmit',
  'onsuspend',
  'ontimeupdate',
  'ontoggle',
  'onvolumechange',
  'onwaiting',
  'onwheel',
  'onauxclick',
  'ongotpointercapture',
  'onlostpointercapture',
  'onpointerdown',
  'onpointermove',
  'onpointerup',
  'onpointercancel',
  'onpointerover',
  'onpointerout',
  'onpointerenter',
  'onpointerleave',
  'onselectstart',
  'onselectionchange',
  'onafterprint',
  'onbeforeprint',
  'onbeforeunload',
  'onhashchange',
  'onlanguagechange',
  'onmessage',
  'onmessageerror',
  'onoffline',
  'ononline',
  'onpagehide',
  'onpageshow',
  'onpopstate',
  'onrejectionhandled',
  'onstorage',
  'onunhandledrejection',
  'onunload',
  'performance',
  'stop',
  'open',
  'alert',
  'confirm',
  'prompt',
  'print',
  'queueMicrotask',
  'requestAnimationFrame',
  'cancelAnimationFrame',
  'captureEvents',
  'releaseEvents',
  'requestIdleCallback',
  'cancelIdleCallback',
  'matchMedia',
  'moveTo',
  'moveBy',
  'resizeTo',
  'resizeBy',
  'find',
  'webkitRequestAnimationFrame',
  'webkitCancelAnimationFrame',
  'fetch',
  'btoa',
  'atob',
  'setTimeout',
  'clearTimeout',
  'setInterval',
  'clearInterval',
  'createImageBitmap',
  'scroll',
  'scrollTo',
  'scrollBy',
  'onappinstalled',
  'onbeforeinstallprompt',
  'crypto',
  'ondevicemotion',
  'ondeviceorientation',
  'ondeviceorientationabsolute',
  'indexedDB',
  'webkitStorageInfo',
  'sessionStorage',
  'localStorage',
  'SharedArrayBuffer',
  'Atomics',
  'globalThis',
  'chrome',
  'WebAssembly',
  'MediaCapabilitiesInfo',
  'OffscreenCanvas',
  'PerformanceNavigationTiming',
  'ReportingObserver',
  'SVGAnimationElement',
  'SVGDiscardElement',
  'SVGMPathElement',
  'SharedWorker',
  'FontFace',
  'Worker',
  'XSLTProcessor',
  'TextDecoderStream',
  'TextEncoderStream',
  'GamepadHapticActuator',
  'Notification',
  'OffscreenCanvasRenderingContext2D',
  'PaymentInstruments',
  'PaymentManager',
  'PaymentRequestUpdateEvent',
  'Permissions',
  'PermissionStatus',
  'EnterPictureInPictureEvent',
  'PictureInPictureWindow',
  'Presentation',
  'PresentationAvailability',
  'PresentationConnection',
  'PresentationConnectionAvailableEvent',
  'PresentationConnectionCloseEvent',
  'PresentationConnectionList',
  'PresentationReceiver',
  'PresentationRequest',
  'PushManager',
  'PushSubscription',
  'PushSubscriptionOptions',
  'RemotePlayback',
  'SpeechSynthesisErrorEvent',
  'SpeechSynthesisEvent',
  'SpeechSynthesisUtterance',
  'webkitSpeechGrammar',
  'webkitSpeechGrammarList',
  'webkitSpeechRecognition',
  'webkitSpeechRecognitionError',
  'webkitSpeechRecognitionEvent',
  'CanvasGradient',
  'CanvasPattern',
  'Path2D',
  'WebGL2RenderingContext',
  'WebGLActiveInfo',
  'WebGLBuffer',
  'WebGLFramebuffer',
  'WebGLProgram',
  'WebGLQuery',
  'WebGLRenderbuffer',
  'WebGLRenderingContext',
  'WebGLSampler',
  'WebGLShader',
  'WebGLShaderPrecisionFormat',
  'WebGLSync',
  'WebGLTexture',
  'WebGLTransformFeedback',
  'WebGLUniformLocation',
  'WebGLVertexArrayObject',
  'BluetoothUUID',
  'speechSynthesis',
  'webkitRequestFileSystem',
  'webkitResolveLocalFileSystemURL',
  'openDatabase'];